# RoofPRO: Smart Tank & Environment Monitoring System

This project is an Arduino Cloud-integrated smart monitoring and control system built on an ESP32 microcontroller. Designed to remotely monitor a water tank's level and environmental conditions, it also provides intelligent control over connected devices like pumps or exhaust fans.

The system is ideal for DIY enthusiasts, smart home builders, or anyone looking to automate and monitor their water supply and surrounding environment with remote access.

## üåü Key Features

* **Smart Water Tank Monitoring:** Uses an RCWL-1655 ultrasonic sensor to accurately measure the water level in a tank. The volume is calculated using a simplified cylinder formula based on the tank's top radius.

* **Volume & Percentage Reporting:** Reports the current water volume in liters and as a percentage of a user-defined full tank capacity (2270 L).

* **Multi-Point Environmental Sensing:** Reads temperature and humidity from two DHT22 sensors and an additional temperature reading from a DS18B20 sensor.

* **4-Channel Relay Control:** Provides remote control over four independent relays via the Arduino Cloud dashboard, allowing you to switch on/off devices like water pumps, exhaust fans, or lights.

* **Intelligent Auto-Off Timer:** Implements an automatic 6-hour timer for Relay 1 (e.g., an exhaust fan). When the fan is turned on, the timer starts, and the relay automatically turns off after 6 hours to save power.

* **Daily Cumulative ON Time Tracking:** Tracks the total cumulative time Relay 1 has been active for the day, resetting the count at midnight using NTP for accurate timekeeping.

* **NTP Time Synchronization:** The ESP32 synchronizes its clock with a network time server, ensuring accurate time for all time-based functions.

* **Seamless Arduino IoT Cloud Integration:** All sensor data, relay states, and control toggles are exposed as properties on the Arduino Cloud dashboard for easy visualization and remote management.

## ‚öôÔ∏è Hardware Requirements

* ESP32 Dev Board

* RCWL-1655 Ultrasonic Sensor

* 2x DHT22 Temperature and Humidity Sensors

* 1x DS18B20 Waterproof Temperature Sensor

* 4-Channel Relay Module

* Breadboard and jumper wires

* A power supply for the ESP32 and relay module

## üîå Software & Libraries

* Arduino IDE with ESP32 board support

* **Arduino Cloud Sketch:** This project is built using the code generated by the Arduino Cloud (with manual modifications).

* **Libraries:**

    * `DHT.h`

    * `DallasTemperature.h`

    * `OneWire.h`

    * `time.h` (Standard C library)

* **Arduino Cloud Account:** Required to create a "Thing" with the necessary properties and access the dashboard.

## üöÄ Getting Started

1.  **Set up Arduino Cloud:**

    * Go to your Arduino Cloud dashboard.

    * Create a new "Thing."

    * Add the following properties (ensure types and permissions match):

        * `humi1` (float, Read Only)

        * `temp1` (float, Read Only)

        * `humi2` (float, Read Only)

        * `temp2` (float, Read Only)

        * `temp3` (float, Read Only)

        * `relay1` (boolean, Read & Write)

        * `relay2` (boolean, Read & Write)

        * `relay3` (boolean, Read & Write)

        * `relay4` (boolean, Read & Write)

        * `relay1CumulativeOnHours` (float, Read Only)

        * `tankVolume` (float, Read Only)

        * `tankVolumeLiters` (float, Read Only)

    * The Arduino Cloud will automatically generate a `thingProperties.h` file.

2.  **Upload the Sketch:**

    * Open your Arduino IDE.

    * Copy and paste the provided sketch code into your `.ino` file.

    * Ensure your Arduino Cloud credentials are configured in your IDE.

    * Select the correct ESP32 board and port.

3.  **Configure Constants:**

    * In the sketch, adjust the `SENSOR_MOUNT_OFFSET_CM` constant to match the physical distance (in centimeters) from the face of your ultrasonic sensor to the top rim of the tank. For example:

        ```cpp
        const float SENSOR_MOUNT_OFFSET_CM = 15.0; // Your measured offset
        ```

    * Verify `TANK_TOTAL_VOLUME_LITERS` is set to `2270.0` if that is your desired full volume reference.

4.  **Wiring:**

    * Connect all the sensors and the relay module to the specified GPIO pins on the ESP32 as defined in the sketch's `#define` statements. Refer to your ESP32 board's pinout diagram.

5.  **Monitor & Control:**

    * Upload the code to your ESP32.

    * Use the Arduino Cloud dashboard to monitor your tank's water level and environmental conditions, and to remotely control your connected relays.
